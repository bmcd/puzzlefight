<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title> PMFKKK </title>
  
  <style type='text/css'>
    
  </style>
  <script src="Engine.js"></script>
  <script src="lobby.js"></script>
   	<!-- Notice the URL, this is handled by socket.io on the server automatically, via express -->
		<script type="text/javascript" src="/socket.io/socket.io.js"></script>
		
			<!-- This will create a connection to socket.io, and print the user serverid that we sent from the server side. --> 
		<script type="text/javascript">
 
				//This is all that needs
			var socket = io.connect('/');
            var clientId;
				//Now we can listen for that event
			socket.on('onconnected', function( data ) {
 
					//Note that the data is the object we sent from the server, as is. So we can assume its id exists. 
		  		console.log( 'Connected successfully to the socket.io server. My server side ID is ' + data.id );
		  		clientId = data.id;
		  		drawLobby(data);
		  	});
		  	socket.on('joinedGame', function(data) {
		  	    console.log("joinedGame");
		  	    clearLobby();
		  	    playerNumber = data.playerNumber;
		  	    startPractice(data);
		  	});
		  	socket.on('startSpec', function(data) {
		  	    clearLobby();
		  	    playerNumber = data.playerNumber;
		  	    startSpectating(data);
		  	});
		  	socket.on('first', function(queue) {
		  	    startGame(queue);
		  	});
		  	socket.on('start', function(queue) {
		  	    socket.emit('readyAgain', {});
		  	    startGame(queue);
		  	});
		  	socket.on('restart', function(queue) {
		  	    socket.emit('readyAgain', {});
		  	    restartGame(queue);
		  	});
		  	socket.on('reset', function() {
		  	    endGame();
		  	});
		  	socket.on('yourTurn', function(data) {
		  	    console.log('In yourTurn');
		  	    firstPlayer = null;
		  	    secondPlayer = null;
		  	    joinGame(data.gameNumber);
		  	});
		  	socket.on('kicked', function() {
		  	    alert('Game ended');
		  	    refresh();
		  	});
		  	socket.on('createdGame', function(data) {
		  	    joinGame(data.gameNumber);
		  	});
		  	socket.on('pausePractice', function(data) {
		  	    clearTimeout(firstPlayer.timeout); 
		  	    paused = true;
		  	});
		  	socket.on('unpausePractice', function(data) {
		  	    firstPlayer.drawBoat(); 
		  	    paused = false;
		  	});
		  	socket.on('pauseGame', function(data) {
		  	    pauseGame();
		  	});
		  	socket.on('unpauseGame', function(data) {
		  	    firstPlayer.drawBoat();
		  	});
		  	socket.on('ready', function(data) {
		  	    firstPlayer.changeReady(data.ready);
		  	});
		  	socket.on('startPractice', function (data) {
		  	    if (!inPractice) { startPractice(data); };
		  	});
		  	socket.on('incomingBlocks', function(blocks) {
		  	    firstPlayer.receiveBlocks(blocks.number);
		  	});
		  	socket.on('boat', function(sent) {
		  	    opponent.drawBoat(sent);
		  	});
		  	socket.on('waiting', function(sent) {
		  	    opponent.drawWaiting(sent);
		  	});
		  	socket.on('grid', function(sent) {
		  	    opponent.drawGrid(sent);
		  	});
		  	socket.on('specBoat', function(sent) {
		  	    if (sent.playerNumber == 0) {
		  	        firstPlayer.drawBoat(sent);
		  	    } else {
		  	        secondPlayer.drawBoat(sent);
		  	    };
		  	});
		  	socket.on('specWaiting', function(sent) {
		  	    if (sent.playerNumber == 0) {
		  	        firstPlayer.drawWaiting(sent);
		  	    } else {
		  	        secondPlayer.drawWaiting(sent);
		  	    };
		  	});
		  	socket.on('specGrid', function(sent) {
		  	    if (sent.playerNumber == 0) {
		  	        firstPlayer.drawGrid(sent);
		  	    } else {
		  	        secondPlayer.drawGrid(sent);
		  	    };
		  	});
		var joinGame = function(number) {
            console.log("joining game " + number);
            socket.emit('joinGame', { gameNumber: number });
        };
        var createGame = function() {
            socket.emit('createGame', {});
        };
        var refresh = function() {
            socket.emit('refresh', {});
        };
				//Now we can listen for that event
		  	socket.on('message', function(data) {
		  	    console.log(data.message);
		  	});
		  	socket.on('alert', function(data) {
		  	    alert(data.message);
		  	});
		  	socket.on('refresh', function(data) {
		  	    drawLobby(data);
		  	});
 
		</script>
  
  </head>
<body bgcolor="#2c3e50">
<canvas id="background" width="1160" height="680" style="position: absolute; background: #2c3e50;"></canvas>
<canvas id="playerA" width="320" height="530" style="position: absolute; left: 100px; top: 30px; background: url(images/transpBlack75.png);"></canvas>
<canvas id="playerAWaiting" width="140" height="700" style="position: absolute; left: 440px; top: 30px; "></canvas>
<canvas id="playerB" width="320" height="530" style="position: absolute; left: 740px; top: 30px; background: url(images/transpBlack75.png);"></canvas>
<canvas id="playerBWaiting" width="140" height="700" style="position: absolute; left: 580px; top: 30px;"></canvas>
<canvas id="playerABoat" width="320" height="560" style="position: absolute; left: 100px;"></canvas>
<canvas id="playerBBoat" width="320" height="560" style="position: absolute; left: 740px;"></canvas>
<canvas id="roundCanvas" width="292" height="530" style="position: absolute; left: 433px; top: 30;"></canvas>
<canvas id="lobbyCanvas" width="1160" height="680" style="position: absolute; background: #2c3e50;"></canvas>
<button id="0" type="button" style="position: absolute; top: 38px; left: 40px; display: none;">Join</button>
<button id="1" type="button" style="position: absolute; top: 68px; left: 40px; display: none;">Join</button>
<button id="2" type="button" style="position: absolute; top: 98px; left: 40px; display: none;">Join</button>
<button id="3" type="button" style="position: absolute; top: 128px; left: 40px; display: none;">Join</button>
<button id="4" type="button" style="position: absolute; top: 158px; left: 40px; display: none;">Join</button>
<button id="5" type="button" style="position: absolute; top: 188px; left: 40px; display: none;">Join</button>
<button id="6" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="7" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="8" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="9" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="10" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="11" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="12" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="13" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="14" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="15" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="16" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="17" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="18" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="19" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="20" type="button" style="position: absolute; top: 138px; left: 40px; display: none;">Join</button>
<button id="createGameButton" type="button" style="position: absolute; left: 90px;">Create New Game</button>
<button id="refresh" type="button" style="position: absolute; left: 210px;">Refresh List</button>
<script type="text/javascript">
    document.getElementById("0").addEventListener("click", function() { joinGame(0);});
    document.getElementById("1").addEventListener("click", function() { joinGame(1);});
    document.getElementById("2").addEventListener("click", function() { joinGame(2);});
    document.getElementById("3").addEventListener("click", function() { joinGame(3);});
    document.getElementById("4").addEventListener("click", function() { joinGame(4);});
    document.getElementById("5").addEventListener("click", function() { joinGame(5);});
    document.getElementById("6").addEventListener("click", function() { joinGame(6);});
    document.getElementById("7").addEventListener("click", function() { joinGame(7);});
    document.getElementById("8").addEventListener("click", function() { joinGame(8);});
    document.getElementById("9").addEventListener("click", function() { joinGame(9);});
    document.getElementById("10").addEventListener("click", function() { joinGame(10);});
    document.getElementById("11").addEventListener("click", function() { joinGame(11);});
    document.getElementById("12").addEventListener("click", function() { joinGame(12);});
    document.getElementById("13").addEventListener("click", function() { joinGame(13);});
    document.getElementById("14").addEventListener("click", function() { joinGame(14);});
    document.getElementById("15").addEventListener("click", function() { joinGame(15);});
    document.getElementById("16").addEventListener("click", function() { joinGame(16);});
    document.getElementById("17").addEventListener("click", function() { joinGame(17);});
    document.getElementById("18").addEventListener("click", function() { joinGame(18);});
    document.getElementById("19").addEventListener("click", function() { joinGame(19);});
    document.getElementById("20").addEventListener("click", function() { joinGame(20);});
    document.getElementById("createGameButton").addEventListener("click", function() { createGame();});
    document.getElementById("refresh").addEventListener("click", function() { refresh();});
</script>
  <script src="Puzzle.js">
  </script>  
</body>


</html>

